[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "BM327 Workshop 1: Seeking the Source of Hospital Infection",
    "section": "",
    "text": "Preface to the 2024-25 presentation\nWelcome to the BM327 (Being a Biomolecular Scientist 3) bioinformatics workshop 1 for 2024-25.\nThis is the first presentation of this material, and we would be very grateful to hear feedback about it by email or through the GitHub repository Issues page.",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation"
    ]
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "BM327 Workshop 1: Seeking the Source of Hospital Infection",
    "section": "Overview",
    "text": "Overview\nThis workshop asks you to carry out common bioinformatics analyses to trace the likely source of a Pseudomonas aeruginosa infection in a hospital burns unit. You will be using online bioinformatics services to do this.\n\n\n\n\n\n\nImportant Note\n\n\n\nThere is new material in this workshop that is not covered in lectures, and this material is examinable. Please take care to read the text in the expandable callout boxes, as well as that for the workshop, to be sure you have understood the topic and obtain full value from the exercise.\nThe workshop material will remain live online for the duration of BM327, and you can revisit it whenever you wish, for practice or revision.\n\n\nYou should be able to complete this workshop in under two hours.",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation"
    ]
  },
  {
    "objectID": "index.html#learning-objectives",
    "href": "index.html#learning-objectives",
    "title": "BM327 Workshop 1: Seeking the Source of Hospital Infection",
    "section": "Learning Objectives",
    "text": "Learning Objectives\nBy the end of this workshop, students will be able to:\n\nPerform quality control on Illumina sequencing data\nMap Illumina-sequenced reads to a reference genome, to identify sequence variants\nGenerate and annotate a phylogenetic tree\nUse genomic data to make an informed judgement about the likely source of a nosocomial infection",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation"
    ]
  },
  {
    "objectID": "index.html#assessment",
    "href": "index.html#assessment",
    "title": "BM327 Workshop 1: Seeking the Source of Hospital Infection",
    "section": "Assessment",
    "text": "Assessment\nThis workshop activity itself is not formally assessed although, as noted, all the material it contains is examinable. There is a formative assessment in the form of short answer questions on MyPlace, which you should complete as part of the workshop.",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Workshop Introduction",
    "section": "",
    "text": "1.1 Sick burns\nIt’s been a couple of years since your local mayor proudly opened the new burns ward at your local hospital (Figure 1.1).\nThe unit is a modern, purpose-built 15 bed ward, with 11 side-rooms and two dual-bedded rooms (Figure 15.1). Any patients requiring mechanical ventilation or organ support are usually treated in two self-contained cubicles, located in the trauma critical care unit. As is typical in the UK, burns patients receive shower cart hydrotherapy as a central part of their treatment.\nUnfortunately, Pseudomonas aeruginosa is a ubiquitous opportunistic pathogen in healthcare settings, and the ward has rapidly regressed to the mean situation of UK hospitals in which up to one in three burns patients become colonised with P. aeruginosa, typically leading to bacteraemia, soft tissue infection or pneumonia (Mahar et al. (2010), Reynolds and Kollef (2021), Roy et al. (2024), Figure 1.2).",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Workshop Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#sick-burns",
    "href": "intro.html#sick-burns",
    "title": "1  Workshop Introduction",
    "section": "",
    "text": "Figure 1.1: This is apparently what Bing Image Generator thinks a mayor opening a burns unit looks like.\n\n\n\n\n\n\n\n\n\n\n\nFigure 1.2: Burn wound infection microbes and their effects on burns patients. Reproduced from Roy et al. (2024) (CC-BY-NC-4.0)",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Workshop Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#the-study",
    "href": "intro.html#the-study",
    "title": "1  Workshop Introduction",
    "section": "1.2 The study",
    "text": "1.2 The study\nIn a nosocomial setting P. aeruginosa especially affects patients with impaired immunity. Outbreaks are frequently reported to be associated with water sources such as taps, showers, mixer valves, sink traps and drains (Trautmann, Lepper, and Haller (2005), Breathnach et al. (2012)). Outbreaks transmitted via water have resulted in fatal cases such as at a neonatal critical care unit in Belfast (Wise (2012)).\nYou are part of a team conducting an observational, prospective study into the occurrence and spread of P. aeruginosa on this burns ward. Patients were recruited from arrivals presenting with burns injuries covering greater than 7% of of their total body surface area.\nAll recruited patients were screened for whether they already carried P. aeruginosa in their wounds, urine, or stool. Samples were then taken from each patient during their stay on the ward. If P. aeruginosa was found while the patient was on the ward, then wound swabs and twice-weekly urine samples were taken from the patient.\n\n\n\n\n\n\n\n\nFigure 1.3: The 15 bed burns ward layout. Beds 1-4 are located in dual-bedded rooms, and beds 5-15 are located in side-rooms. Water supply pipes are indicated by the blue lines\n\n\n\n\n\n\n\n\n\nPatient samples\n\n\n\n\nwound swabs\nurine\nstool\n\n\n\nSamples were also taken from the patient’s environment and water from outlets in their bed space, at weekly intervals, during their stay.\n\n\n\n\n\n\nEnvironment samples\n\n\n\n\nshower head rosette\nshower drain\nshower chair/trolley\ntap\nbedside table\npatient chair\ninstruments",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Workshop Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#the-samples",
    "href": "intro.html#the-samples",
    "title": "1  Workshop Introduction",
    "section": "1.3 The samples",
    "text": "1.3 The samples\nDuring the course of the study, five patients and a number of individual samples were found to be positive for P. aeruginosa (Figure 1.4).\n\n\n\n\n\n\nFigure 1.4: A schematic view of samples found to be positive for P. aeruginosa in the study. Time in days is shown along the x axis. The y axis shows bed numbers in the burns unit (upper, Figure 15.1) and the critical care unity. Each circular icon indicates a positive isolate of P. aeruginosa. The letter in the icon indicates the MLST clade to which the P. aeruginosa sample belongs. The colour of the icon indicates the environment from which it was sampled: red = wound, purple = sputum, yellow = urine, blue = water, green = environment. Patient icons indicate individual patient enrolments in the study, and their locations (arrows indicate movement between beds). Boxes 1-5 indicate patients infected with P. aeruginosa.\n\n\n\nYour role, as the bioinformatician attached to the study, is to investigate the genome sequences of bacteria from these samples, and determine what evidence there is for transmission of P. aeruginosa to patients.\n\n\n\n\nBreathnach, A S, M D Cubbon, R N Karunaharan, C F Pope, and T D Planche. 2012. “Multidrug-Resistant Pseudomonas Aeruginosa Outbreaks in Two Hospitals: Association with Contaminated Hospital Waste-Water Systems.” J. Hosp. Infect. 82 (1): 19–24.\n\n\nMahar, Patrick, Alexander A Padiglione, Heather Cleland, Eldho Paul, Melissa Hinrichs, and Jason Wasiak. 2010. “Pseudomonas Aeruginosa Bacteraemia in Burns Patients: Risk Factors and Outcomes.” Burns 36 (8): 1228–33.\n\n\nReynolds, Dan, and Marin Kollef. 2021. “The Epidemiology and Pathogenesis and Treatment of Pseudomonas Aeruginosa Infections: An Update.” Drugs 81 (18): 2117–31.\n\n\nRoy, Souvik, Preeti Mukherjee, Sutrisha Kundu, Debashrita Majumder, Vivek Raychaudhuri, and Lopamudra Choudhury. 2024. “Microbial Infections in Burn Patients.” Acute Crit. Care 39 (2): 214–25.\n\n\nTrautmann, Matthias, Philipp M Lepper, and Mathias Haller. 2005. “Ecology of Pseudomonas Aeruginosa in the Intensive Care Unit and the Evolving Role of Water Outlets as a Reservoir of the Organism.” Am. J. Infect. Control 33 (5 Suppl 1): S41–9.\n\n\nWise, Jacqui. 2012. “Three Babies Die in Pseudomonas Outbreak at Belfast Neonatal Unit.” BMJ 344 (jan24 1): e592.",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Workshop Introduction</span>"
    ]
  },
  {
    "objectID": "galaxy-registration.html",
    "href": "galaxy-registration.html",
    "title": "2  Register An Account with Galaxy",
    "section": "",
    "text": "2.1 Introduction\nIn this workshop you will be working on Galaxy, an open source scientific workflow and data integration platform (Galaxy Community (2024)). Galaxy is a framework for performing reproducible computational biology and bioinformatics, democratising the field so that scientists with no programming or other computing experience can still carry out bioinformatic analyses on their own data, in their web browser.",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Register An Account with Galaxy</span>"
    ]
  },
  {
    "objectID": "galaxy-registration.html#introduction",
    "href": "galaxy-registration.html#introduction",
    "title": "2  Register An Account with Galaxy",
    "section": "",
    "text": "Galaxy instances\n\n\n\n\n\nThe Galaxy software is open source and can be downloaded and installed freely on any computer that it can run on. Each such installation is called a Galaxy instance. The Galaxy instance that you will be working on is the EU Galaxy instance at https://usegalaxy.eu/. This is the largest Galaxy instance in Europe and gives access to over 2500 scientific tools. It is free to use, and is maintained by the Galaxy team at Freiburg.\nThere are many other Galaxy instances, some private, and some public and free for anyone to use, such as:\n\nhttps://usegalaxy.org/: The Galaxy Project public server, supporting biomedical research.\nhttps://galaxyproject.org/use/usegalaxy-fr/: A general-purpose Galaxy server, based in France\nhttps://galaxyproject.org/use/usegalaxy-au/: The Australian UseGalaxy server\n\nGalaxy can be thought of as a library of bioinformatics tools and, just as different libraries may contain differing collections of books, each Galaxy instance may make available different sets of tools, or different versions of similar tools. As a result some analyses may be possible on one Galaxy instance, but not another.\nWhen you use Galaxy it is important to be clear when writing up your analysis methods to be clear about which Galaxy instance is used, and which version of each tool was used in the analysis.\n\n\n\n\n2.1.1 Workflows\nThe key concept in Galaxy is the workflow. A workflow is a series, or chain, of analysis steps that takes some input data (one or more files or datasets) through a series of actions, to generate one or more result files. Typically, the output of one step will serve as the input to the next step, but more complicated branching workflows can also be created (Figure 2.1).\n\n\n\n\n\n\nFigure 2.1: Galaxy workflow editor view of a Galaxy workflow that runs the same tool (RXLR Motifs) with three different settings, and compares the results using a Venn diagram (reproduced from Cock et al. (2013)). The workflow runs from left to right. A single Input dataset is fed into the RXLR Motifs tool three times, applying a different method each time. Each run of the RXLR Motifs tool generates a different set of output sequences, which are passed as input to the Filter tool. The output from all three runs of the Filter tool is passed to the Venn Diagram tool, along with the original input dataset, to generate a Venn Diagram\n\n\n\nUsing Galaxy, you will build up a powerful bioinformatic analysis workflow to analyse your data, step-by-step, using a web browser. Galaxy allows you to save and share your workflows, to encourage reuse and reproducibility.",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Register An Account with Galaxy</span>"
    ]
  },
  {
    "objectID": "galaxy-registration.html#registering-with-galaxy",
    "href": "galaxy-registration.html#registering-with-galaxy",
    "title": "2  Register An Account with Galaxy",
    "section": "2.2 Registering with Galaxy",
    "text": "2.2 Registering with Galaxy\n\n\n\n\n\n\nRegister with usegalaxy.eu\n\n\n\nThe first action you should take in this workshop, if you do not already have an account at https://usegalaxy.eu/, is to create an account at https://usegalaxy.eu/.\n\n\n\nGo to the Galaxy login/registration page\nIf you have a usegalaxy.eu account already, then log in using your details and move on to the workshop proper.\nIf you do not already have a usegalaxy.eu account, then click on the Register here link.\nEnter your university email address in the Email address field.\nChoose a secure password and enter it into the Password and Confirm password fields.\nChoose a public name to show (other people will be able to see this) and enter it in the Public name field.\nClick on the Create button.\n\n\n\n\n\n\n\nImportant\n\n\n\nYou will receive a validation email at the account you register with. You must confirm your email to proceed.\n\n\n\n\n\n\nCock, Peter J A, Björn A Grüning, Konrad Paszkiewicz, and Leighton Pritchard. 2013. “Galaxy Tools and Workflows for Sequence Analysis with Applications in Molecular Plant Pathology.” PeerJ 1 (September): e167.\n\n\nGalaxy Community. 2024. “The Galaxy Platform for Accessible, Reproducible, and Collaborative Data Analyses: 2024 Update.” Nucleic Acids Res. 52 (W1): W83–94.",
    "crumbs": [
      "Preface to the {{< var ay >}} presentation",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Register An Account with Galaxy</span>"
    ]
  },
  {
    "objectID": "galaxy.html",
    "href": "galaxy.html",
    "title": "Galaxy",
    "section": "",
    "text": "The chapters in this section of the workshop will guide you through registering an account with Galaxy EU, and uploading workshop data to the Galaxy instance.\n\n3  Join the Training Session at https://usegalaxy.eu/join-training/\n4  Download Workshop Data to your computer\n5  Upload Data to Galaxy to your Galaxy history\n\n\n\n\n\n\n\nFigure 1: Today’s workshop is enabled by Galaxy EU Teaching Infrastructure as a Service.",
    "crumbs": [
      "Galaxy"
    ]
  },
  {
    "objectID": "join-session.html",
    "href": "join-session.html",
    "title": "3  Join the Training Session",
    "section": "",
    "text": "3.1 The Galaxy workspace layout\nAfter you join the session, you will see the Galaxy workspace, which should look similar to Figure 3.1. There are three sections to the workspace: the Tools sidebar, the History/Workflow sidebar, and the central Workspace area. You will become more familiar with these as you move through the workshop.",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Join the Training Session</span>"
    ]
  },
  {
    "objectID": "join-session.html#the-galaxy-workspace-layout",
    "href": "join-session.html#the-galaxy-workspace-layout",
    "title": "3  Join the Training Session",
    "section": "",
    "text": "Figure 3.1: An empty Galaxy workspace. The workspace is divided into three sections. On the left is the Tools sidebar, which presents the software tools available on the current Galaxy instance. On the right is the History or Workflow sidebar, which describes the data and steps being used in the current Galaxy workflow. The largest section, in the centre, shows details of a selected tool including options to set or change parameters, or the contents of the dataset, depending what is selected from the History sidebar.\n\n\n\n\n\n\n\n\n\nThe Tools sidebar\n\n\n\n\n\nThe Tools sidebar on the left of the window initially presents all the tools available on the Galaxy instance being used. These are grouped into sections by the kind of task they can be used for, such as manipulating text, or assembling sequenced reads.\nThis sidebar also provides useful links, such as for uploading your own data to the Galaxy instance (Upload Data), and for importing data from public databases, like Ensembl. There is also a search field at the top of the sidebar which initially contains the text search tools. You can enter the name of a tool or action into this field, and the sidebar will present the matching software on the Galaxy instance.\n\n\n\n\n\n\n\n\n\nThe History/Workflow sidebar\n\n\n\n\n\nThe History/Workflow sidebar at the right of the window will initially be empty. As you work through the exercises this sidebar will become populated with your data, the actions you take on the data, and the results of those actions. The History will have no name specified, so you should see the placeholder Unnamed history, and the text This history is empty.\nWhen you log into a Galaxy instance that you have used before, you may see the most recent history/workflow that you used, and you may have options for loading previous histories/workflows into the current workspace.\n\n\n\n\n\n\n\n\n\nThe Workspace\n\n\n\n\n\nThe largest, central region of the window is the Workspace. This is an area that presents several kinds of information. Depending on context, it may provide information about the Galaxy instance, present datasets (or summaries/visualisations of datasets), or ways to interact with the individual tools that you will use.\n\n\n\n\n\n\n\n\n\n\n\n(a) News and information\n\n\n\n\n\n\n\n\n\n\n\n(b) Inspecting data\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) Interactive visualisations\n\n\n\n\n\n\n\n\n\n\n\n(d) Setting parameters for software and analyses\n\n\n\n\n\n\n\nFigure 3.2: Four uses of the Workspace area in Galaxy.",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Join the Training Session</span>"
    ]
  },
  {
    "objectID": "join-session.html#give-a-name-to-the-history",
    "href": "join-session.html#give-a-name-to-the-history",
    "title": "3  Join the Training Session",
    "section": "3.2 Give A Name To The History",
    "text": "3.2 Give A Name To The History\nIt is helpful to give the workflow/history that you work with a name. This will help you find it again when you reuse the Galaxy EU instance.\n\n\n\n\n\n\nTip\n\n\n\n\nWhen you name a workflow, give it a concise title that expresses the purpose of the workflow.\nYou can also add annotation that describes the workflow and provides more information than the name alone conveys.\nYou can rename or re-annotate your workflow at any time.\n\n\n\nTo assign a name to your workflow:\n\nClick on the pen icon next to Unnamed history\nEnter a name for the workflow in the top Unnamed history field\nEnter additional text describing the workflow in the lower Annotation (optional) field\nClick the Save button.\n\n\n\n\n\n\n\nVideo: Renaming A Galaxy Workflow",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Join the Training Session</span>"
    ]
  },
  {
    "objectID": "join-session.html#footnotes",
    "href": "join-session.html#footnotes",
    "title": "3  Join the Training Session",
    "section": "",
    "text": "This is a single server with 120 cores and 205 GB of RAM.↩︎",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Join the Training Session</span>"
    ]
  },
  {
    "objectID": "download-data.html",
    "href": "download-data.html",
    "title": "4  Download Workshop Data",
    "section": "",
    "text": "4.1 Sequencing reads for your isolate",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Download Workshop Data</span>"
    ]
  },
  {
    "objectID": "download-data.html#sequencing-reads-for-your-isolate",
    "href": "download-data.html#sequencing-reads-for-your-isolate",
    "title": "4  Download Workshop Data",
    "section": "",
    "text": "Illumina paired-end reads, forward direction(ERR531380_1.fastq.gz)\nIllumina paired-end reads, reverse direction(ERR531380_2.fastq.gz)",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Download Workshop Data</span>"
    ]
  },
  {
    "objectID": "download-data.html#pseudomonas-aeruginosa-reference-strain-for-snp-comparison",
    "href": "download-data.html#pseudomonas-aeruginosa-reference-strain-for-snp-comparison",
    "title": "4  Download Workshop Data",
    "section": "4.2 Pseudomonas aeruginosa reference strain for SNP comparison",
    "text": "4.2 Pseudomonas aeruginosa reference strain for SNP comparison\n\nP. aeruginosa PA01 genome sequence (.fasta)(GCF_000006765.1_ASM676v1_genomic.fna)",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Download Workshop Data</span>"
    ]
  },
  {
    "objectID": "download-data.html#room-8-isolate-assembly-for-snp-comparison",
    "href": "download-data.html#room-8-isolate-assembly-for-snp-comparison",
    "title": "4  Download Workshop Data",
    "section": "4.3 Room 8 isolate assembly for SNP comparison",
    "text": "4.3 Room 8 isolate assembly for SNP comparison\n\nSPAdes assembly of isolate 1031 (ERR531413), from the room 8 shower hose(ERR531413_asm.fasta)\n\n\n\n\n\n\n\nYour Working Directory\n\n\n\nWhen you have downloaded all the files required for the workshop, the contents of the BM327_Workshop folder should resemble the image in Figure 4.1.\n\n\n\n\n\n\nFigure 4.1: macOS BM327_Workshop folder with all files downloaded.",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Download Workshop Data</span>"
    ]
  },
  {
    "objectID": "upload-data.html",
    "href": "upload-data.html",
    "title": "5  Upload Data to Galaxy",
    "section": "",
    "text": "5.1 Uploading your data\nThere are three main routes to uploading your data onto the Galaxy instance.",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Upload Data to Galaxy</span>"
    ]
  },
  {
    "objectID": "upload-data.html#uploading-your-data",
    "href": "upload-data.html#uploading-your-data",
    "title": "5  Upload Data to Galaxy",
    "section": "",
    "text": "5.1.1 Use the You can load your own data link in an empty workflow\nThis option is only visible when you have an empty workflow. Click on the You can load your own data link under This history is empty. This will bring up a dialogue box. You can drag and drop a file or files into the dialogue box, or use the Choose local file button to navigate to the location of your files.\n\nClick on the You can load your own data link.\nDrag the two workshop data files ending with .fastq.gz into the dialogue box.\nClick on the Start button.\nThe files will appear in the History sidebar.\nClick the Close button in the file dialogue.\n\n\n\n\n\n\n\nData file colours\n\n\n\n\n\nWhen the data files are first added to the workflow, they have a grey background. This indicates that Galaxy knows about the files, and is preparing to upload them.\nWhen Galaxy begins to upload the files, the background changes to orange.\nWhen the upload is complete, the background turns green.\nIf there is a problem with uploading, the background turns red (please signal to a demonstrator if this happens for you).\n\n\n\n\n\n\n\n\n\nData file types\n\n\n\n\n\nYou will have noticed the Auto-detect dropdown boxes when you uploaded your files. Galaxy is able to process files that describe many data types, including genome sequence data, transcriptome data, mass spectrometry data, and so on. Each individual file contains a single type of data.\nGalaxy is usually clever enough to determine for itself what data is in a particular file, but sometimes it cannot recognise the contents, and you may have to specify the file type by choosing from the options in this drop-down box.\n\n\n\n\n\n\n\n\n\nVideo: Uploading files with the You can load your own data link\n\n\n\n\n\n\n\n\n5.1.2 Use the Upload Data button in the Tools sidebar\nThere is an Upload button at the top left of the Galaxy window, in the left-most toolbar. It has a green background and an upload icon. At any point in the analysis, you can click on this button to upload data into the workflow.\n\nClick on the Upload button.\nDrag the GCF_000006765.1_ASM676v1_genomic.fna.gz file into the dialogue box.\nClick on the Start button.\nThe file will appear in the History sidebar.\nClick the Close button in the file dialogue.\n\nThis file is smaller than the files you uploaded above, and should take less time to turn orange, and then green, to indicate that it has uploaded correctly.\n\n\n\n\n\n\nVideo: Uploading files with the Upload button\n\n\n\n\n\n\n\n\n5.1.3 Drag and drop data onto the workspace\nYou can also drag and drop data files directly into the central workspace window of Galaxy. This will trigger the file upload dialogue box.\n\nDrag the ERR531413_asm.fasta file into the Galaxy workspace.\nA Drag files here to upload overlay will appear.\nDrop the file in the overlay. A file upload dialogue box will appear.\nClick on the Start button.\nThe file will appear in the History sidebar.\nClick the Close button in the file dialogue.\n\n\n\n\n\n\n\nVideo: Uploading files by dragging them into the workspace",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Upload Data to Galaxy</span>"
    ]
  },
  {
    "objectID": "upload-data.html#inspecting-data",
    "href": "upload-data.html#inspecting-data",
    "title": "5  Upload Data to Galaxy",
    "section": "5.2 Inspecting Data",
    "text": "5.2 Inspecting Data\nYou can inspect the data you have uploaded to Galaxy visually in two ways.\n\n5.2.1 In the History\nTo view the contents of an uploaded data file in the History.\n\nClick on the file name (e.g. GCF_000006765.1_ASM676v1_genomic.fna). The file descriptor will enlarge.\n\n\nThe descriptor shows the file’s datatype (e.g. “format fasta”)\nAt the bottom of the descriptor, a preview of the dataset is shown, with the first few lines of the data.\n\n\nClick on the file name again to close the file descriptor.\n\n\n\n5.2.2 In the Workspace\nYou can view the complete file contents (or at least a large preview of up to 1MB of data) in the main workspace window, by clicking on the eye icon in the file descriptor.\n\nClick on the eye icon of one of the file descriptors (e.g. ERR531413_asm.fasta). A representation of the data in the file will be shown in the workspace window.\n\n\n\n5.2.3 Using additional tools\nThe open file descriptor presents several icons, just above the data preview. These allow you to:\n\nDownload the dataset to your computer\nObtain a direct URL link to the data\nView details about the dataset\nVisualise the data interactively using an appropriate tool\nShow related datasets\n\nView the video below to see some examples of this output.\n\n\n\n\n\n\nVideo: Using interactive data inspection tools",
    "crumbs": [
      "Galaxy",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Upload Data to Galaxy</span>"
    ]
  },
  {
    "objectID": "workshop.html",
    "href": "workshop.html",
    "title": "Workshop",
    "section": "",
    "text": "The chapters in this section of the site will lead you through each step of the workshop. Please work through these steps in order and, if you get stuck, please ask one of the lecturers or demonstrators for help.\n\nAssessing the quality of sequence read data for your isolate\nPrepare your sequencing read data for assembly\nIdentify sequence variants (SNPs, Single Nucleotide Polymorphisms) between your isolate and a reference genome, and against another study isolate\nAssemble a genome for your isolate\nVisualise your genome assembly\nAssess the quality of your assembly\nUse pubMLST to classify your isolate\nBuild and visualise a phylogenetic tree of isolates from the study\nUse your data to draw conclusions about nosocomial transmission",
    "crumbs": [
      "Workshop"
    ]
  },
  {
    "objectID": "fastqc.html",
    "href": "fastqc.html",
    "title": "6  Inspect Read Quality",
    "section": "",
    "text": "6.1 Using Falco\nUsing good quality input data improves our chance of getting a good quality output assembly.\nWe call the set of sequenced reads we obtain from the sequencer the raw reads. Modern sequencing technologies usually give us high quality data, but it is still possible for some low-quality read sequences to be produced among the raw reads. So that these do not detrimentally affect the quality of our assembly, we first assess the quality of our read data, and then remove low-quality reads and low-quality parts of read sequences. The resulting dataset is often called the cleaned reads or processed reads.\nThis part of the workshop will cover the use of Falco to inspect the quality of your sequence reads.",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Inspect Read Quality</span>"
    ]
  },
  {
    "objectID": "fastqc.html#using-falco",
    "href": "fastqc.html#using-falco",
    "title": "6  Inspect Read Quality",
    "section": "",
    "text": "Navigate to the Falco tool using the Tools sidebar in Galaxy\n\n\nYou can use the search tools field to find Falco\nAlternatively, you will find it under GENOMIC FILE MANIPULATION/FASTA/FASTQ in the sidebar\n\n\nSelect the Falco tool\nRun the Falco tool on each of your FASTQ input files\n\n\nThese are the ERR531380_1.fastq and ERR531380_2.fastq files.\nWith the Falco tool options in the main Workspace window, select the file you want to run Falco on.\nClick on the Run Tool button.\n\n\n\n\n\n\n\nImportant\n\n\n\nMake sure you run Falco on both the forward and reverse read sets.\n\n\n\n\n\n\n\n\nVideo: Using Falco to assess the quality of your sequencing reads\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nFalco takes a few moments to run (but is faster than FastQC, which it has superseded.\nWhen the run is complete, click on the eye icon of the Webpage result to inspect the FastQC output.\n\n\n\n\n\n\nTip\n\n\n\nYou can press and hold CTRL (on a PC) or CMD ⌘ (macOS) when clicking the eye icon to open the result in its own window.",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Inspect Read Quality</span>"
    ]
  },
  {
    "objectID": "fastqc.html#falco-output",
    "href": "fastqc.html#falco-output",
    "title": "6  Inspect Read Quality",
    "section": "6.2 Falco output",
    "text": "6.2 Falco output\nThe output of Falco tells us a lot about the quality of our sequencing data, and we would typically use it to identify problems with our sequencing data. Some important sections are described below, and you can read more about how to diagnose quality issues in your dataset at the links below:\n\nOfficial FastQC documentation\nOfficial Falco documentation\nMichigan State University (MSU) FastQC tutorial\n\n\n\n\n\n\n\nFalco and FastQC\n\n\n\nFalco and FastQC are two different tools, but they perform the same task and give equivalent, if visually distinct, output. Falco output is interpreted in exactly the same way as FastQC output, so it can be helpful to refer to FastQC tutorials and documentation.\n\n\n\n\n\n\n\n\nVideo: Inspecting Falco output in Galaxy\n\n\n\n\n\n\n\n6.2.1 Falco Summary\nThe Falco summary (Figure 6.1) provides an overview that indicates where there may be areas of concern in your data. Each section of the report receives a flag indicating either that it gets a pass (green, with a tick), a warning (amber, with exclamation mark), or a fail (red, with a cross) mark.\n\n\n\n\n\n\n\n\nFigure 6.1: Example Falco summary showing passes for most sections of the report including “Basic Statistics,” warnings for some sections including “Sequence Length Distribution,” and a fail for “Per tile sequence quality”\n\n\n\n\n\n6.2.2 Per base sequence quality\nThe per base sequence quality plot (Figure 6.2) presents the ranges of individual base quality calls across the lengths of the input sequence reads. Higher scores (near 40) indicate better quality.\n\n\n\n\n\n\nTip\n\n\n\nFor good-quality sequence read data, we are looking for a graph where the mean quality (see Figure 6.2) is always showing green, with a score greater than 29.\n\n\n\n\n\n\n\n\nFigure 6.2: Per base sequence quality score plot from Falco indicating high quality sequencing reads. Quality score ranges are presented as a boxplot at each sequence position range.\n\n\n\n\n\n\n\n\n\nCaution\n\n\n\nIt is not unusual for the per-base quality scores to fall quite steeply towards the end of the reads, with Illumina and other sequencing technologies.\nIt is also typical for the quality score to be slightly lower in the first 5-7 bases of the read.\nIf mean quality per base falls below 29, there may be a problem with the sequencing data.\n\n\n\n\n6.2.3 Per sequence quality scores\nThe per sequence quality score (Figure 6.3) summarises the distribution of high quality (higher scores, near 40) and lower quality reads in the complete dataset.\n\n\n\n\n\n\nTip\n\n\n\nIn good quality sequence data, we tend to see a sharp peak towards the right hand side of the plot.\n\n\n\n\n\n\n\n\nFigure 6.3: Per sequence quality score plot from Falco indicating overall high quality sequencing reads.\n\n\n\n\n\n\n\n\n\nCaution\n\n\n\nIf the per sequence quality score appears flat, or plateaus towards the left hand side of the plot, there may be a problem with the sequencing data.",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Inspect Read Quality</span>"
    ]
  },
  {
    "objectID": "fastqc.html#what-do-we-do-about-sequencing-data-problems",
    "href": "fastqc.html#what-do-we-do-about-sequencing-data-problems",
    "title": "6  Inspect Read Quality",
    "section": "6.3 What do we do about sequencing data problems?",
    "text": "6.3 What do we do about sequencing data problems?\nFalco does a great job of alerting us to problems with our sequencing data sets. But, by itself, it cannot remedy these problems.\nModern sequencing methods produce so much read data that the usual approach to excluding poor data is either to exclude (or drop) the read itself, or to trim (throw away) the section of the read sequence that is low quality.\nA popular tool for removing poor quality read data is trimmomatic and you will meet this in Chapter 7.",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Inspect Read Quality</span>"
    ]
  },
  {
    "objectID": "trimmomatic.html",
    "href": "trimmomatic.html",
    "title": "7  Clean Raw Read Data",
    "section": "",
    "text": "7.1 Using trimmomatic\nAs you have seen in Chapter 6 sequence read data can be of variable quality. The usual approach to improving the overall quality of a dataset is to discard low quality reads, and low-quality sections of reads. This is referred to as cleaning raw read data.\nTrimmomatic is a commonly-used software tool for cleaning raw read data that\nThis part of the workshop will guide you through using trimmomatic to clear your sequence read data.",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Clean Raw Read Data</span>"
    ]
  },
  {
    "objectID": "trimmomatic.html#using-trimmomatic",
    "href": "trimmomatic.html#using-trimmomatic",
    "title": "7  Clean Raw Read Data",
    "section": "",
    "text": "Navigate to the trimmomatic tool using the Tools sidebar in Galaxy\n\n\nYou can use the search tools field to find trimmomatic, or look under the FASTA/FASTQ section in the sidebar\n\n\nSelect the trimmomatic tool\nMake sure that Paired-end (two separate input files) is chosen\nSelect the forward and reverse raw read sets (ERR531380_1.fastq.gz ERR531380_2.fastq.gz) as the Input FASTQ files\nSet Perform initial ILLUMINACLIP to Yes; this will trim any remaining Illumina adapters from the read sequences\nUnder Adapter sequences to use select TruSeq3 (paired-ended for MiSeq and HiSeq)\nClick Run Tool\n\n\n\n\n\n\n\nVideo: Using trimmomatic to clean raw sequencing reads",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Clean Raw Read Data</span>"
    ]
  },
  {
    "objectID": "trimmomatic.html#trimmomatic-output",
    "href": "trimmomatic.html#trimmomatic-output",
    "title": "7  Clean Raw Read Data",
    "section": "7.2 trimmomatic Output",
    "text": "7.2 trimmomatic Output\nCleaning your data with trimmomatic generates four output files (Figure 7.1).\n\n\n\n\n\n\n\n\nFigure 7.1: FastQC output files in Galaxy. From the top: unpaired reverse (R2) reads, unpaired forward (R1) reads, paired reverse (R2) reads, and paired forward (R1) reads.\n\n\n\nYou can inspect the contents of these files by clicking on the filename in the History sidebar, and also by clicking on the corresponding eye icon to view the trimmed reads in the workspace.\n\n\n\n\n\n\nVideo: Inspecting trimmomatic output files\n\n\n\n\n\n\n\n\n\n\n\n\nRun Falco again on your cleaned reads to see the improvement in data quality\n\n\n\nFollowing the example from Chapter 6, run Falco again on your newly-cleaned (paired) read sets, to see how the quality has improved.\n\n\n\n\n\n\n\n\nFigure 7.2: Per base quality score plot from Falco indicating an improvement in read quality, post-trimmomatic.",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Clean Raw Read Data</span>"
    ]
  },
  {
    "objectID": "trimmomatic.html#next-steps",
    "href": "trimmomatic.html#next-steps",
    "title": "7  Clean Raw Read Data",
    "section": "7.3 Next steps",
    "text": "7.3 Next steps\nNow that we have clean, high-quality sequencing reads, we can move on to mapping the reads to a reference genome, in Chapter 8",
    "crumbs": [
      "Workshop",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Clean Raw Read Data</span>"
    ]
  },
  {
    "objectID": "mapping.html",
    "href": "mapping.html",
    "title": "Read Mapping",
    "section": "",
    "text": "There are several approaches to comparison of genome sequences. One method is to align (or map) the sequenced reads from one genome to a different, reference genome. Reads will only map to (align with) sequence-similar regions, so it is possible to inspect the alignments and see which parts of the two genomes are similar or dissimilar.\nIn this section, you will use this technique to compar the mapping of your isolate to a reference genome (P. aeruginosa PA01) and to a sequenced isolate from the same study.",
    "crumbs": [
      "Read Mapping"
    ]
  },
  {
    "objectID": "bwamem.html",
    "href": "bwamem.html",
    "title": "8  Map Reads to the Genome",
    "section": "",
    "text": "8.1 Using BWA-MEM2\nRead mapping is a common bioinformatics technique that aligns sequencing reads to a reference genome. It is often used as part of RNA-seq, or transcriptomic, analyses, where the number of sequencing reads aligned to a part of the genome indicates the level to which a gene in that region is transcribed. It is also central to technologies such as ChIP-seq (chromatin immunoprecipitation and sequencing), which enables the locations of regulatory promoter binding sites to be found.\nToday, you will use the same approach to compare the ERR531380 isolate that you have sequenced to a reference Pseudomonas aeruginosa PAO1 genome, and then to an assembly of the ERR53413 isolate sequenced as part of this study. To do this you will use the BWA-MEM2 read mapping software (Vasimuddin et al. (2019)) to align the cleaned forward and reverse reads from your isolate to each of the two reference genomes.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Map Reads to the Genome</span>"
    ]
  },
  {
    "objectID": "bwamem.html#using-bwa-mem2",
    "href": "bwamem.html#using-bwa-mem2",
    "title": "8  Map Reads to the Genome",
    "section": "",
    "text": "Navigate to the BWA-MEM2 tool\nSelect the BWA-MEM2 tool\nChoose Use a genome from history and build index under Will you select a reference genome…\nChoose the GCF_000006765.1_ASM676v1_genomic.fna sequence under Use the following dataset as the reference sequence\nChoose Paired under Single of Paired-end reads\nSelect the (R1 paired) and (R2 paired) trimmomatic output reads\nClick Run Tool\n\n\n\n\n\n\n\nVideo: Mapping ERR513380 reads to a reference genome using BWA-MEM2\n\n\n\n\n\n\n\n\n\n\n\n\nCaution\n\n\n\nBWA-MEM2 can take a few minutes to run to completion.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Map Reads to the Genome</span>"
    ]
  },
  {
    "objectID": "bwamem.html#bwa-mem2-output",
    "href": "bwamem.html#bwa-mem2-output",
    "title": "8  Map Reads to the Genome",
    "section": "8.2 BWA-MEM2 Output",
    "text": "8.2 BWA-MEM2 Output\nUnlike many of the other tools you will use today, BWA-MEM produces binary file output, which is not human-readable. However, Galaxy can read it and generate a human-friendly translation. The output format of BWA-MEM2 is .bam, and this can be used as an annotation track in a visualisation tool such as JBrowse, wchich you will meet next, in Chapter 9.\n\n\n\n\n\n\nVideo: Visualising the BWA-MEM2 .bam output as text",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Map Reads to the Genome</span>"
    ]
  },
  {
    "objectID": "bwamem.html#next-steps",
    "href": "bwamem.html#next-steps",
    "title": "8  Map Reads to the Genome",
    "section": "8.3 Next Steps",
    "text": "8.3 Next Steps\nWe can find SNPs by visual inspection in a tool like JBrowse, and you will try this in Chapter 9.\n\n\n\n\nVasimuddin, Md, Sanchit Misra, Heng Li, and Srinivas Aluru. 2019. “Efficient Architecture-Aware Acceleration of BWA-MEM for Multicore Systems.” In 2019 IEEE International Parallel and Distributed Processing Symposium (IPDPS). Rio de Janeiro, Brazil: IEEE.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Map Reads to the Genome</span>"
    ]
  },
  {
    "objectID": "jbrowse.html",
    "href": "jbrowse.html",
    "title": "9  Visualise the Mapping",
    "section": "",
    "text": "9.1 Visualising the Read Mapping\nThe .bam file generated in Chapter 8 contains the information we need to understand how well the reads map to . However, being plain-text files and often quite large, they are not easy to read and process intuitively.\nTo get the most benefit out of these files, we usually visualise them using an appropriate software tool. The choice of tool depends on the reason for visualisation. The Artemis software (Carver et al. (2012)) is useful for interactive manual genome annotation; Tablet is an excellent tool for investigating genome assembly and sequence variation (Milne et al. (2013))1; and Proksee is an online service (Grant et al. (2023)) often used to obtain representative images of genome assembly annotations.\nIn this section, you will use JBrowse (Diesh et al. (2023)) to visualise your reference mapping interactively. JBrowse is a lightweight genome browser written in JavaScript that can run as a standalone application, or embedded as a web tool, as it is in Galaxy.\nTo use JBrowse to investigate your read mapping you need to tell it both what to display, and how to display it.\nClick on the eye icon for the new JBrowse output. The magnifying glass icons can be used to zoom in and out of the visualisation. The check boxes to the left of the window can be used to control whether the reference genome and/or the annotation tracks are visible.\nYou can click on the header of the SNP track in JBrowse and select Pin to top, so that you can zoom in and see individual SNPs, as in the video below.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualise the Mapping</span>"
    ]
  },
  {
    "objectID": "jbrowse.html#visualising-the-read-mapping",
    "href": "jbrowse.html#visualising-the-read-mapping",
    "title": "9  Visualise the Mapping",
    "section": "",
    "text": "Warning\n\n\n\nThere are a number of new concepts being introduced here, and they may not make sense until you have tried to visualise your data.\nIf you follow the instructions below, and watch the video, you should find that everything works, and the meaning of unfamiliar terms like track group will become apparent.\n\n\n\nNavigate to the JBrowse tool in the Tools sidebar\nSelect the JBrowse tool\nUnder Reference genome to display, select the Use a genome from history option\nSelect the GCF_000006765.1_ASM676v1_genomic.fna genome file in Select the reference genome\nClick on + Insert Track Group to add a new track group\nIn the new track group, enter Mapping into the Track Category field\nClick on + Insert Annotation Track to add a new track to hold the mapping data\nMake sure that the Track Type of the new annotation track is BAM Pileups\nIn BAM Track Data, select the BWA-MEM2 .bam output file\nSelect Yes under Autogenerate SNP Track\nClick Run Tool\n\n\n\n\n\n\n\nVideo: Configuring JBrowse to visualise BWA-MEM2 mapping data\n\n\n\n\n\n\n\n\nSelect the following tracks to be shown:\n\n\nReference sequence\nMapping (SNPs/Coverage)\n\n\nZoom in to the genome to obtain a visualisation of reads that map to the reference genome, similar to that in Figure 9.1.\n\n\n\n\n\n\n\nFigure 9.1: JBrowse visualisation of a BWA-MEM2 mapping ofERR531380 reads reads against a P. aeruginosa reference genome. The JBrowse tool shows the reference sequence (but zoomed out too far for individual bases to be visible), and a mapping track. The mapping track shows individual SNPs (teardrops), and total mapping read depth (the stacks above the teardrops).\n\n\n\n\n\n\n\n\n\n\nTODO\n\n\n\nADD CALLOUT TO SAY NOT TO WORRY ABOUT ZOOMING OUT/NOT DISPLAYING\n\nalso MAF’s error message on zooming out too far\n\n\n\n\n\n\n\n\n\nVideo: Visualising SNPs in JBrowse\n\n\n\n\n\n\n\n\n\n\n\n\nQUESTIONS\n\n\n\n\nDo the ERR31380 reads map uniformly to the reference genome?\nWhen ERR31380 reads map to a SNP at the reference genome, what proportion of the mapping reads contains the SNP?\nBased on the number of SNPs you can see in a 1,000bp region of the reference genome, estimate the total number on SNPs.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualise the Mapping</span>"
    ]
  },
  {
    "objectID": "jbrowse.html#next-steps",
    "href": "jbrowse.html#next-steps",
    "title": "9  Visualise the Mapping",
    "section": "9.2 Next Steps",
    "text": "9.2 Next Steps\nWe can find SNPs by visual inspection in a tool like JBrowse, but there can be very many of them - as you can see. To ensure reproducibility and accuracy, and avoid errors we need to use dedicated software and pipelines when analysing mapping data. You will have a chance to do this in Chapter 10.\n\n\n\n\nCarver, Tim, Simon R Harris, Matthew Berriman, Julian Parkhill, and Jacqueline A McQuillan. 2012. “Artemis: An Integrated Platform for Visualization and Analysis of High-Throughput Sequence-Based Experimental Data.” Bioinformatics 28 (4): 464–69.\n\n\nDiesh, Colin, Garrett J Stevens, Peter Xie, Teresa De Jesus Martinez, Elliot A Hershberg, Angel Leung, Emma Guo, et al. 2023. “JBrowse 2: A Modular Genome Browser with Views of Synteny and Structural Variation.” Genome Biol. 24 (1): 74.\n\n\nGrant, Jason R, Eric Enns, Eric Marinier, Arnab Mandal, Emily K Herman, Chih-Yu Chen, Morag Graham, Gary Van Domselaar, and Paul Stothard. 2023. “Proksee: In-Depth Characterization and Visualization of Bacterial Genomes.” Nucleic Acids Res. 51 (W1): W484–92.\n\n\nMilne, Iain, Gordon Stephen, Micha Bayer, Peter J A Cock, Leighton Pritchard, Linda Cardle, Paul D Shaw, and David Marshall. 2013. “Using Tablet for Visual Exploration of Second-Generation Sequencing Data.” Brief. Bioinform. 14 (2): 193–202.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualise the Mapping</span>"
    ]
  },
  {
    "objectID": "jbrowse.html#footnotes",
    "href": "jbrowse.html#footnotes",
    "title": "9  Visualise the Mapping",
    "section": "",
    "text": "Tablet is the standalone tool I would prefer to use to visualise this data (LP).↩︎",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualise the Mapping</span>"
    ]
  },
  {
    "objectID": "snippy.html",
    "href": "snippy.html",
    "title": "10  Find Sequence Variants",
    "section": "",
    "text": "10.1 Using snippy\nsnippy is a sequence variant finding pipeline, designed for haploid genomes such as prokaryotes and viruses.\nAs with most kinds of bioinformatics data, there is a data format designed specifically to capture the important elements of the data, and snippy outputs its results in this format (called VCF).",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Find Sequence Variants</span>"
    ]
  },
  {
    "objectID": "snippy.html#using-snippy",
    "href": "snippy.html#using-snippy",
    "title": "10  Find Sequence Variants",
    "section": "",
    "text": "Navigate to the snippy tool\nSelect snippy\nSelect Use a genome from history and build index from Will you select a reference genome…\nChoose the GCF_000006765.1_ASM676v1_genomic.fna file in Use the following dataset as the reference sequence\nSelect Paired under Single or Paired-end reads\nChoose the cleaned post-trimmomatic (R1 paired) data for the forward reads\nChoose the cleaned post-trimmomatic (R2 paired) data for the reverse reads\nClick Run Tool\n\n\n\n\n\n\n\nVideo: Identifying sequence variants using snippy\n\n\n\n\n\n\n\n\n\n\n\n\nCaution\n\n\n\nsnippy can take a few minutes to run to completion.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Find Sequence Variants</span>"
    ]
  },
  {
    "objectID": "snippy.html#snippy-output",
    "href": "snippy.html#snippy-output",
    "title": "10  Find Sequence Variants",
    "section": "10.2 snippy Output",
    "text": "10.2 snippy Output\nsnippy provides output in .vcf format, which is designed to be processed by bioinformatics software and is not the most understandable form for humans. To see the snippy output in a more human-readable form, click on the eye icon for the snps table output (Figure 10.1).\n\n\n\n\n\n\nFigure 10.1: The snippy snps table output. Key columns in the output are: column 2, indicating the position of the variant; column 4, indicating the reference base(s); column 5, indicating the dominant variant in the mapped data; and column 6, showing the counts of each variant in the mapped data.\n\n\n\n\n\n\n\n\n\nVideo: Inspecting snippy output\n\n\n\n\n\n\n\n\n\n\n\n\nQUESTIONS\n\n\n\n\nHow many variants are there in the SNPs table? How does this compare with your estimate from JBrowse visualisation?\nCan you find SNPs from the snippy output manually using JBrowse in your earlier visualisation?\nCan you find any SNPs that are different or inconsistent between the JBrowse and snippy outputs?\n\n\n\n\n\n\n\nExplaining your observations\n\n\n\n\n\nBioinformatic tools that perform the same kind of task may differ in exactly how they carry out that task. This can result in them generating output that is not identical, even if they claim to calculate the same kind of value or make the same kind of measurement.\nEven different versions of the same tool might differ and produce different output, so it is good practice to explain exactly which version of a software tool you use in your work.\n\n\n\n\n\n\n\n\n\n\n\nCHALLENGE\n\n\n\nThe PAO1 isolate was sequenced at the turn of the millennium (Stover et al. (2000)) and is a common laboratory reference straiin. It would be useful to map your isolate’s reads against an assembled genome from your study. You have one such genome assembly in ERR531413_asm.fasta\n\nMap your ERR531380 isolate reads to the ERR531413_asm.fasta assembly using snippy.\nHow many sequence variants are there between the two genomes?\nWhy might you think that your study isolate shares a more, or less, recent common ancestory with ERR531413?",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Find Sequence Variants</span>"
    ]
  },
  {
    "objectID": "snippy.html#next-steps",
    "href": "snippy.html#next-steps",
    "title": "10  Find Sequence Variants",
    "section": "10.3 Next Steps",
    "text": "10.3 Next Steps\nIn the next section you will assemble the genome of your isolate. The resulting sequence will be informative for tracing the likely routes of transmission in the hospital ward.\n\n\n\n\nStover, C K, X Q Pham, A L Erwin, S D Mizoguchi, P Warrener, M J Hickey, F S Brinkman, et al. 2000. “Complete Genome Sequence of Pseudomonas Aeruginosa PAO1, an Opportunistic Pathogen.” Nature 406 (6799): 959–64.",
    "crumbs": [
      "Read Mapping",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Find Sequence Variants</span>"
    ]
  },
  {
    "objectID": "assembly.html",
    "href": "assembly.html",
    "title": "Genome Assembly",
    "section": "",
    "text": "In this section, you will assess the quality of a genome assembly for your study isolate ERR531380.",
    "crumbs": [
      "Genome Assembly"
    ]
  },
  {
    "objectID": "shovill.html",
    "href": "shovill.html",
    "title": "11  Assemble the ERR531380 Genome",
    "section": "",
    "text": "11.1 Visualising the Assembly\nIn this section you will investigate the quality of this genome assembly visually using the Bandage tool. You will also use the CheckM tool to obtain a measure of genome completeness.\nThe Bandage software package (Wick et al. (2015)) can take assembly output from tools such as SPAdes and Shovill, and visualise them as a graph. This is a useful step in assessing the quality of an assembly and can help identify poorly-assembled regions and when there is potential unintentional sequencing of co-cultures of related strains, rather than an axenic isolate.\nTo use Bandage to visualise your genome assembly",
    "crumbs": [
      "Genome Assembly",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Assemble the `ERR531380` Genome</span>"
    ]
  },
  {
    "objectID": "shovill.html#visualising-the-assembly",
    "href": "shovill.html#visualising-the-assembly",
    "title": "11  Assemble the ERR531380 Genome",
    "section": "",
    "text": "Bandage documentation\nBandage website\n\n\n\nNavigate to the Bandage Image tool using the Tools sidebar in Galaxy\nSelect the Bandage Image tool\nMake sure that you have selected the .gfa file as the Graphical Fragment Assembly input\nClick Run Tool\n\n\n\n\n\n\n\nVideo: Visualising the ERR531380 assembly using Bandage Image\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nInspect the assembly graph by clicking on the eye icon for the Assembly Graph Image output.",
    "crumbs": [
      "Genome Assembly",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Assemble the `ERR531380` Genome</span>"
    ]
  },
  {
    "objectID": "shovill.html#estimating-assembly-quality",
    "href": "shovill.html#estimating-assembly-quality",
    "title": "11  Assemble the ERR531380 Genome",
    "section": "11.2 Estimating Assembly Quality",
    "text": "11.2 Estimating Assembly Quality\nThe CheckM software (Parks et al. (2015)) is a suite of tools used to assess the quality of a bacterial assembly. It estimates the completeness of the genome by looking for the presence of single copy marker genes (SCMGs) for a stated phylogenetic lineage. The more of these marker genes that can be determined to be present in the genome, the more complete the assembly is assumed to be.\n\nCheckM docmentation\nCheckM website\n\nThe use CheckM to estimate the quality of your assembly:\n\nNavigate to the CheckM taxonomy_wf tool using the Tools sidebar in Galaxy\nSelect the Taxonomic rank of Species and set the Taxon of interest to be Pseudomonas aeruginosa (the identity of the isolate is known, or at least strongly suspected, on the basis of polyphasic tests)\nUnder Data structure for bins select In individual datasets and choose the ERR531380.contigs.fasta file\nClick on Run Tool\n\n\n\n\n\n\n\nVideo: Estimating assembly quality using CheckM",
    "crumbs": [
      "Genome Assembly",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Assemble the `ERR531380` Genome</span>"
    ]
  },
  {
    "objectID": "shovill.html#next-steps",
    "href": "shovill.html#next-steps",
    "title": "11  Assemble the ERR531380 Genome",
    "section": "11.3 Next steps",
    "text": "11.3 Next steps\nWith the draft genome assembly you have for ERR531380 you can use pubMLST to classify your isolate in more detail, using Galaxy and the pubMLST server.\n\n\n\n\nParks, Donovan H, Michael Imelfort, Connor T Skennerton, Philip Hugenholtz, and Gene W Tyson. 2015. “CheckM: Assessing the Quality of Microbial Genomes Recovered from Isolates, Single Cells, and Metagenomes.” Genome Res. 25 (7): 1043–55.\n\n\nPrjibelski, Andrey, Dmitry Antipov, Dmitry Meleshko, Alla Lapidus, and Anton Korobeynikov. 2020. “Using SPAdes DE Novo Assembler.” Curr. Protoc. Bioinformatics 70 (1): e102.\n\n\nWick, Ryan R, Mark B Schultz, Justin Zobel, and Kathryn E Holt. 2015. “Bandage: Interactive Visualization of de Novo Genome Assemblies.” Bioinformatics 31 (20): 3350–52.",
    "crumbs": [
      "Genome Assembly",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Assemble the `ERR531380` Genome</span>"
    ]
  },
  {
    "objectID": "classification.html",
    "href": "classification.html",
    "title": "Isolate Classification",
    "section": "",
    "text": "There are multiple approaches to identifyiing and classifying a sequenced bacterial isolate. In this section, you will use pubMLST to identify your organism and its clade group.",
    "crumbs": [
      "Isolate Classification"
    ]
  },
  {
    "objectID": "pubmlst.html",
    "href": "pubmlst.html",
    "title": "12  PubMLST Classification",
    "section": "",
    "text": "12.1 Classification with Galaxy",
    "crumbs": [
      "Isolate Classification",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>PubMLST Classification</span>"
    ]
  },
  {
    "objectID": "pubmlst.html#classification-with-galaxy",
    "href": "pubmlst.html#classification-with-galaxy",
    "title": "12  PubMLST Classification",
    "section": "",
    "text": "Navigate to the MLST tool in the Tools sidebar\nSelect the ERR531380 assembly as the input_files\nClick on Run Tool\nClick on the Eye icon to see the result\n\n\n\n\n\n\n\nVideo: Use Galaxy’s MLST tool to classify your isolate\n\n\n\n\n\n\n\n\n\n\n\n\nQUESTION\n\n\n\n\nWhat is the sequence type (ST) of your isolate as reported by Galaxy MLST?\n\n\n\n\n ✗paeruginosa\n\n\n ✓395\n\n\n ✗6, 5, 1, 1, 1, 12, 1\n\n\n\n\n\n\n\n\n\n\nHint\n\n\n\n\n\nCheck the Help section of the MLST tool for a description of the output format.",
    "crumbs": [
      "Isolate Classification",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>PubMLST Classification</span>"
    ]
  },
  {
    "objectID": "pubmlst.html#classification-at-pubmlst",
    "href": "pubmlst.html#classification-at-pubmlst",
    "title": "12  PubMLST Classification",
    "section": "12.2 Classification at pubMLST",
    "text": "12.2 Classification at pubMLST\n\nIn a new tab of your browser open the PubMLST website\nClick on Organisms\nNavigate to Pseudomonas aeruginosa and click on Typing\nUnder Query a sequence click on Single sequence\nSelect the ERR531380 assembly as input\nClick on SUBMIT\n\n\n\n\n\n\n\nWarning\n\n\n\nThe pubMLST classification may take a couple of minutes.\n\n\n\n\n\n\n\n\nVideo: Use PubMLST to classify your isolate",
    "crumbs": [
      "Isolate Classification",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>PubMLST Classification</span>"
    ]
  },
  {
    "objectID": "pubmlst.html#next-steps",
    "href": "pubmlst.html#next-steps",
    "title": "12  PubMLST Classification",
    "section": "12.3 Next Steps",
    "text": "12.3 Next Steps\nNow you have assembled and classified your isolate, you can use some additional data prepared by your helpful colleague to reconstruct a phylogenetic tree for isolates obtained from the burns ward.",
    "crumbs": [
      "Isolate Classification",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>PubMLST Classification</span>"
    ]
  },
  {
    "objectID": "phylogenetics.html",
    "href": "phylogenetics.html",
    "title": "Phylogenetics",
    "section": "",
    "text": "Phylogenetic methods allow us to reconstruct the evolutionary history of, and relationships between, organisms. Here, we can use these approaches to obtain evidence about the likely order and route of transmission of bacterial isolates in the context of an infection outbreak, such as this study.\nIn this section, you will construct a phylogenetic tree from the aligned SNPs (single-nucleotide polymorphisms) of a set of isolates from rooms 6, 9, and 11 - and a reference isolate believed to have existed prior to the study. You will visualise the tree you construct, and use it to propose a potential order of events for infection and transmission in this burns ward.",
    "crumbs": [
      "Phylogenetics"
    ]
  },
  {
    "objectID": "tree.html",
    "href": "tree.html",
    "title": "13  Building a Phylogenetic Tree",
    "section": "",
    "text": "13.1 What isolates are being analysed?\nThe isolate genomes your colleague has assembled came from the beds and sources shown in Table 15.1.\nTable 13.1: Sequenced isolates",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Building a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "tree.html#what-isolates-are-being-analysed",
    "href": "tree.html#what-isolates-are-being-analysed",
    "title": "13  Building a Phylogenetic Tree",
    "section": "",
    "text": "Note\n\n\n\n\nGenomeID is the accession number for the read data.\nSampleID is the sample number from the study.\nPatientID uniquely identifies a patient.\nBed indicates the corresponding bed for the patient.\nSpecimen indicates whether the isolate was sampled directly from the patient, from a water sample, or swabbed from an environmental surface.\nSource names the kind of surface or substance that was sampled.\nDays indicates the number of days after the study start at which the isolate was collected.",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Building a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "tree.html#inferring-a-phylogenetic-tree-with-raxml",
    "href": "tree.html#inferring-a-phylogenetic-tree-with-raxml",
    "title": "13  Building a Phylogenetic Tree",
    "section": "13.2 Inferring a phylogenetic tree with RaxML",
    "text": "13.2 Inferring a phylogenetic tree with RaxML\n\nNavigate to RaxML in the Tools sidebar\nSet the source file to be the .fasta file you just uploaded\nCheck that the Model type is Nucleotide with the GTRGAMMA model\nClick on Run Tool\n\n\n\n\n\n\n\nVideo: Inferring a tree using RaxML",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Building a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "tree.html#inspect-the-tree-file-and-visualise-the-tree-in-galaxy",
    "href": "tree.html#inspect-the-tree-file-and-visualise-the-tree-in-galaxy",
    "title": "13  Building a Phylogenetic Tree",
    "section": "13.3 Inspect the tree file and visualise the tree in Galaxy",
    "text": "13.3 Inspect the tree file and visualise the tree in Galaxy\n\nClick on the Eye icon nect to the Best-scoring ML Tree output\n\n\n\n\n\n\n\nTODO\n\n\n\nASK SOME QUESTIONS HERE\n\n\n\nNavigate to ETE tree viewer in the Tools sidebar\nIn the Newick Tree to visualise field, select the Best-scoring ML Tree output\nSet Resolve Taxonomic IDs to No\nClick on Run Tool\nWhen the visualisation finishes, click on the Eye icon next to the output\n\n\n\n\n\n\n\nVideo: Visualising the tree in Galaxy\n\n\n\n\n\n\n\n\n\n\n\n\nTODO\n\n\n\nASK SOME QUESTIONS HERE",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Building a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "tree.html#next-steps",
    "href": "tree.html#next-steps",
    "title": "13  Building a Phylogenetic Tree",
    "section": "13.4 Next Steps",
    "text": "13.4 Next Steps\nIt would be useful to be able to annotate the tree with a visual representation of the sample type and room for each isolate. You will do this in Chapter 14 using iTOL.",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Building a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol.html",
    "href": "itol.html",
    "title": "14  Visualising the Phylogenetic Tree",
    "section": "",
    "text": "14.1 Downloading the tree\nIn this section you will use the online tool iTOL to visualise the phylogenetic tree you created in Chapter 13. This tree represents evolutionary relationships between the 33 study isolates, as inferred from differences in their genome sequences. By appropriately rooting and annotating the tree, you should be able to draw conclusions concerning the routes of transmission of these isolates.\nTo use iTOL you need to upload a file representing the phylogenetic tree. At the moment your tree file only exists on Galaxy so you need to download it to your local project folder. To download the tree file:\nThis will place the Newick-formatted tree file in your local directory.",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Visualising the Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol.html#downloading-the-tree",
    "href": "itol.html#downloading-the-tree",
    "title": "14  Visualising the Phylogenetic Tree",
    "section": "",
    "text": "Click on the Best-scoring ML Tree history item\nClick on the floppy disk icon1\nSelect the appropriate location to download the file\nClick Save\n\n\n\n\n\n\n\n\nVideo: Downloading the tree file",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Visualising the Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol.html#upload-the-tree-to-itol",
    "href": "itol.html#upload-the-tree-to-itol",
    "title": "14  Visualising the Phylogenetic Tree",
    "section": "14.2 Upload the tree to iTOL",
    "text": "14.2 Upload the tree to iTOL\n\nNavigate to the iTOL website at https://itol.embl.de/\nClick on Upload a tree\nClick on Browse and navigate to your downloaded Newick tree file\nSelect the tree file and click Open. The tree file’s name should appear at the iTOL site\nClick Upload\n\nA basic representation of your tree should appear, as in Figure 14.1\n\n\n\n\n\n\n\n\nFigure 14.1: Initial tree representation at iTOL\n\n\n\n\n\n\n\n\n\nVideo: Upload the tree file to iTOL",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Visualising the Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol.html#re-rooting-the-tree",
    "href": "itol.html#re-rooting-the-tree",
    "title": "14  Visualising the Phylogenetic Tree",
    "section": "14.3 Re-rooting the tree",
    "text": "14.3 Re-rooting the tree\n\n\n\n\n\n\nImportant\n\n\n\nYour colleague has been super-helpful and identified the reference genome that is assumed to be ancestral to all of the genomes in the tree. The ancestral genome, which should be considered the root of the tree, is ERR531413_asm.fasta.ref. Rooting the tree at this genome should make the tree reflect the time sequence of divergence of each isolate from their common ancestors.\n\n\n\nClick on the ancestral node in the tree: ERR531413_asm.fasta.ref\nClick on Tree structure -&gt; Re-root the tree here\n\n\n\n\n\n\n\nVideo: Re-root the tree to the known ancestral reference\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nAs a reminder, and to help with tree annotation, the interactive table of isolate metadata is shown below in Table 15.1.\n\n\n\n\nTable 14.1: Sequenced isolates\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTODO\n\n\n\nADD QUESTION ASKING STUDENTS TO CONSIDER THE CLADE STRUCTURE",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Visualising the Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol.html#annotating-the-tree",
    "href": "itol.html#annotating-the-tree",
    "title": "14  Visualising the Phylogenetic Tree",
    "section": "14.4 Annotating the tree",
    "text": "14.4 Annotating the tree\nWe are interested in how P. aeruginosa may have spread around the burns ward. We can gain some insight into this by annotating the phylogenetic tree, which represents the evolutionary history of the isolates, with metadata. For example, annotating the tree with the bed number might help us understand whether the isolates tend to stay in one location, or whether they move freely between beds. Similarly, annotating the specimen type can help us understand if there is transmission between patients, from environment or water to the patient, or from the patient to the environment.\n\n\n\n\n\n\nTip\n\n\n\nIt can help visibility to increase the linewidth for all branches in the tree.\nTo do this, look for Branch options in the Basic iTOL tab of the control panel. There is an option called Line style. Click on the chevrons to obtain a branch line weight that is pleasing to the eye.\n\n\n\n14.4.1 Relabel branches to indicate the beds they were sampled from\n\nSort Table 15.1 by bed number by clicking on one of the triangles next to the Bed header\nIdentify the branches corresponding to the genomes sampled from bed 6\nModify the label for each branch to indicate the bed it was sampled from (e.g. change ERR531398_asm.fasta to ERR531398_bed6)\n\n\nClick on the branch label\nClick on Label -&gt; Text -&gt; Edit label\nEnter the new label\nClick on the tick (changes won’t be saved if you do not do this)\n\n\nRepeat steps 2 and 3 for the genomes sampled from beds 9 and 11\n\n\n\n\n\n\n\nVideo: Relabel branches to reflect the beds they were sampled from\n\n\n\n\n\n\n\n\n14.4.2 Change label colour to indicate the specimen type\n\nSort Table 15.1 by bed number by clicking on one of the triangles next to the SpecimenType header\nIdentify the branches corresponding to the Environmental samples\nModify the background colour for each of these branches to be the same colour (e.g. green)\n\n\nClick on the branch label\nClick on Label -&gt; Text -&gt; Edit label\nEnter the new label\nClick on the tick (changes won’t be saved if you do not do this)\n\n\nRepeat steps 2 and 3 for the Patient and Water samples, using contrasting colours\n\n\n\n\n\n\n\nVideo: Colour branch labels to indicate the sample source\n\n\n\n\n\n\n\n\n14.4.3 Relabel branches to indicate the patients from which they were sampled\n\nSort Table 15.1 by patient by clicking on one of the triangles next to the PatientID header\nIdentify branches with a SpecimenType of Patient\nUpdate the label for each such branch to indicate the patient corresponding to the sample (e.g. change ERR531300 bed 11 to ERR531300 bed 11 P01)\n\n\n\n\n\n\n\nVideo: Colour branch labels to indicate the sample source",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Visualising the Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol.html#next-steps",
    "href": "itol.html#next-steps",
    "title": "14  Visualising the Phylogenetic Tree",
    "section": "14.5 Next Steps",
    "text": "14.5 Next Steps\nNow that you have reconstructed a phylogenetic tree and annotated it with metadata for each sequenced isolate, you can move on to interpreting the data in Chapter 15.",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Visualising the Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol.html#footnotes",
    "href": "itol.html#footnotes",
    "title": "14  Visualising the Phylogenetic Tree",
    "section": "",
    "text": "We know you’re all too young to have used a floppy disk, but humour us…↩︎",
    "crumbs": [
      "Phylogenetics",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Visualising the Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "investigation.html",
    "href": "investigation.html",
    "title": "Investigation",
    "section": "",
    "text": "Now that you have obtained a phylogenetic tree from the study isolates, you can begin to consider some questions that might lead you to understand paths of transmission.",
    "crumbs": [
      "Investigation"
    ]
  },
  {
    "objectID": "questions.html",
    "href": "questions.html",
    "title": "15  Tracing the Source",
    "section": "",
    "text": "15.1 How does the burns unit layout influence potential routes of transmission?\nYou have constructed a phylogenetic tree similar to that in Figure 15.2 for each of the study isolates in Table 15.1. In this section, you will use this information, and the plan of the burns unit in Figure 15.1 to draw inferences about the likely routes of transmission of P. aeruginosa in the burns unit.\nWork through the questions below to form your own conclusions concerning how the evidence does or does not support hypotheses about particular routes of transmission.\nUse what you know or can infer from Figure 15.1 and Table 15.1 to answer questions and determine the plausibility of the hypotheses below.",
    "crumbs": [
      "Investigation",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Tracing the Source</span>"
    ]
  },
  {
    "objectID": "questions.html#how-does-the-burns-unit-layout-influence-potential-routes-of-transmission",
    "href": "questions.html#how-does-the-burns-unit-layout-influence-potential-routes-of-transmission",
    "title": "15  Tracing the Source",
    "section": "",
    "text": "15.1.1 Hypothesis 1\nSuppose that P. aeruginosa was introduced to the unit via the mains water system, which enters at the top left of Figure 15.1.\nAssume that the pipes and fittings are contaminated in sequence, as water moves through the water system, and that P. aeruginosa is continuously accumulating mutations.\n\n\n\n\n\n\nQUESTION\n\n\n\n\nConsider each scenario below and decide which you think is most plausible.\n\n\n\n\n ✗All of the isolates sampled from each bed will be identical, and a phylogenetic tree would not help trace contamination.\n\n\n ✓The earliest-contaminated beds on the left-hand side of the unit (9-15) will appear to share a distinct common ancestor from those on the right-hand side of the unit (1-8).\n\n\n ✗The isolates will appear to diverge from the initial contaminant in order of bed number (i.e. bed 1 samples diverge first, then bed 2 samples, then bed 3 samples).\n\n\n ✗The isolates will appear to diverge from the initial contaminant in reverse order of bed number (i.e. bed 15 samples diverge first, then bed 14 samples, then bed 3 samples).\n\n\n\n\n\n\n\n\n\n\nHint\n\n\n\n\n\nTry tracing the possible paths through the pipe system, moving from the top left into the ward. Where are the branching points? If the P. aeruginosa isolates are constantly accumulating mutations, how might the branching points correspond to points on a phylogenetic tree?\nTry sketching the tree you think you would see.\n\n\n\n\n\n\n\n\n\nExplanation\n\n\n\n\n\nThe flow of mains water would be expected always to be towards the outlets, and populations of P. aeruginosa that found themselves on the left-hand side of the ward would be unlikely to be able to move through the pipes to the right-hand side (and vice versa). If we assume initial contamination via mains water, and no subsequent cross-contamination between beds, we would expect beds 9-15 to share a common ancestor that is not shared by beds 1-8 (and vice versa).\n\n\n\n\n\n\n\n\n\n\n\n\nHow to use this answer\n\n\n\nIs the tree you constructed compatible with this hypothesis?\n\n\n\n\n\n\nHint\n\n\n\n\n\nDo isolates from beds 9 and 11 share a common ancestor that is not shared with beds 1 or 6?\n\n\n\n\n\n\n\n15.1.2 Hypothesis 2\nIt is possible that P. aeruginosa isolates are transferred frequently between beds, for example by patient movement, clinician or nurse movement, or other poor infection control.\nThe ward is designed with side rooms to limit the amount of casual cross contamination that occurs.\nSuppose that, despite this deliberate design effort, patient and staff movement frequently contaminates one bed with P. aeruginosa isolates from other beds.\n\n\n\n\n\n\nQUESTION\n\n\n\n\nConsider each scenario below and decide which you think would be most plausible.\n\n\n\n\n ✓Isolates from several different beds would appear to share the same recent common ancestor, and it would not be possible to separate a phylogenetic tree into clades corresponding to individual beds.\n\n\n ✗Isolates from the same bed would appear to share a more recent common ancestor with each other than with isolates from any other bed.\n\n\n ✗Isolates from the left-hand side of the ward would appear to share a more recent common ancestor with each other than with isolates from the other side of the ward.\n\n\n ✗Isolates would appear to diverge from the same common ancestor in the order of bed number (bed 1 being most anciently diverged, bed 15 being most recently diverged).\n\n\n\n\n\n\n\n\n\n\nHint\n\n\n\n\n\nWhat kinds of movements from room to room might you expect to see? Would there always be a pattern? Suppose you went into room 13 and picked up an isolate, then contaminated room 5 with it. What would the tree look like? What would the tree look like if you did this 100 times between different pairs of rooms?\n\n\n\n\n\n\n\n\n\nExplanation\n\n\n\n\n\nThe phylogenetic tree would still produce a history of the isolates that reflected the sequence of mutations that had occurred. The tree would have a clade structure, with groups of isolates that were more recently-diverged from a common ancestor than other groups. But, if there was frequent transfer of isolates between rooms, the clades would not correspond to any one location, and the isolates from any particular clade would be likely to be found in many different rooms.\n\n\n\n\n\n\n\n\n\n\n\n\nHow to use this answer\n\n\n\nIs the tree you constructed compatible with this hypothesis?\n\n\n\n\n\n\nHint\n\n\n\n\n\nIs there a clade structure to your tree, where there is (more or less) one bed per clade?",
    "crumbs": [
      "Investigation",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Tracing the Source</span>"
    ]
  },
  {
    "objectID": "questions.html#did-the-patients-bring-their-own-p.-aeruginosa",
    "href": "questions.html#did-the-patients-bring-their-own-p.-aeruginosa",
    "title": "15  Tracing the Source",
    "section": "15.2 Did the patients bring their own P. aeruginosa?",
    "text": "15.2 Did the patients bring their own P. aeruginosa?\n\n15.2.1 Hypothesis 3\nSuppose that the patients were already contaminated with a different strain of P. aeruginosa acquired from some other location (perhaps their home) before they took their beds on the ward.\nAssume that the unit was already contaminated with P. aeruginosa, but that there is no cross-contamination between beds.\nAssume that there is contamination between patient and bed.\n\n\n\n\n\n\nQUESTION\n\n\n\n\nConsider each scenario below and decide which you think would be plausible.\n\n\n\n\n ✗Isolates sampled from the patient would closely resemble isolates sampled from other beds, but not their own bed.\n\n\n ✓Isolates sampled from the patient would closely resemble isolates sampled from their bed, but not other beds.\n\n\n ✓Isolates sampled from other beds in the unit would resemble isolates sampled from the patient.\n\n\n ✗Isolates sampled from the patient would not resemble any isolates sampled from the unit.\n\n\n\n\n\n\n\n\n\n\nHint\n\n\n\n\n\nContamination can be bidirectional. If a patient and their bed are in contact then material, including bacteria, can be transferred from the patient to the bed, and from the bed to the patient. More than one answer may be plausible.\n\n\n\n\n\n\n\n\n\nExplanation\n\n\n\n\n\nIf the patient introduces P. aeruginosa from an outside source to their bed, then isolates from that patient’s bed may resemble those from an outside source (but not other isolates from the unit). In the absence of cross-contamination, only that bed would carry an isolate that was introduced by the patient.\nIf the patient acquires P. aeruginosa from the previously-contaminated unit, and the isolates from each bed are related, then isolates from the patient may resemble those from any bed on the unit (though will likely be most similar to those from their own bed).\n\n\n\n\n\n\n\n\n\n\n\n\nHow to use this answer\n\n\n\nIs the tree you constructed compatible with this hypothesis?\n\n\n\n\n\n\nHint\n\n\n\n\n\nDo the isolates sampled from patients resemble isolates sampled from the beds, or do they appear to be a different lineage entirely?\nIs it possible that the study’s sampling strategy could pick up contamination in one direction (e.g. bed to patient), but not the other (patient to bed)?\n\n\n\n\n\n\n\n15.2.2 Hypothesis 4\nSuppose that the patients were already contaminated with a different strain of P. aeruginosa acquired from some other location (perhaps their home) before they took their beds on the ward.\nAssume that the unit was already contaminated with P. aeruginosa, but that there is no cross-contamination between beds.\nAssume that there is contamination between patient and bed.\n\n\n\n\n\n\nQUESTION\n\n\n\n\nUse the Days column from Table 15.1 (you may need to scroll to the right), and your tree, when considering each scenario below to decide which you think would be plausible, based on the evidence.\n\n\n\n\n ✗Patients P01 and P04 independently introduced from outside the burns unit two different lineages of P. aeruginosa that were sampled from their wounds.\n\n\n ✗Patient P01 introduced the strain sampled from both patients from outside the unit, contaminating bed 11. Later, bed 11 contaminated patient P04.\n\n\n ✓Patients P01 and P04 each acquired the strain that was sampled from their wounds from bed 11.\n\n\n ✗Patient P04 introduced the strain sampled from both patients from outside the unit, contaminating bed 11. Later, bed 11 contaminated patient P01.\n\n\n\n\n\n\n\n\n\n\nHint\n\n\n\n\n\nThe branching order of the tree implies the order of divergence of isolates, and patients can’t travel backwards in time to infect other patients. Use the data in Table 15.1 to check if time travel would be necessary for some of the options.\n\n\n\n\n\n\n\n\n\nExplanation\n\n\n\n\n\nPatient P01 was sampled two months before patient P04 occupied the same bed, so P04 could not have contaminated them. Also, some of the isolates from PA04 appeared to diverge earlier than the isolate sampled from P01, and so are unlikely to have been introduced to the unit by P01. The close relation of isolates from P01 and P04 suggests that they were not independent lineages introduced to the burns unit.\n\n\n\n\n\n\n\n\n\n\n\n\nHow to use this answer\n\n\n\nIs the tree you constructed compatible with this hypothesis?\n\n\n\n\n\n\nHint\n\n\n\n\n\nDo the isolates sampled from patients look to be distinct from those that were sampled from the unit’s environment and water system?",
    "crumbs": [
      "Investigation",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Tracing the Source</span>"
    ]
  },
  {
    "objectID": "questions.html#next-steps",
    "href": "questions.html#next-steps",
    "title": "15  Tracing the Source",
    "section": "15.3 Next Steps",
    "text": "15.3 Next Steps\nPlease follow the link to the MyPlace formative quiz below and answer the questions.\n\nMyPlace Formative Quiz\n\nThen read on to Chapter 16.",
    "crumbs": [
      "Investigation",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Tracing the Source</span>"
    ]
  },
  {
    "objectID": "conclusion.html",
    "href": "conclusion.html",
    "title": "Conclusion",
    "section": "",
    "text": "This workshop is based on a real study, and uses publicly-available data from that study. Find out what really happened in 16  Epilogue.",
    "crumbs": [
      "Conclusion"
    ]
  },
  {
    "objectID": "epilogue.html",
    "href": "epilogue.html",
    "title": "16  Epilogue",
    "section": "",
    "text": "16.1 The Real Study\nThis workshop is based on a real study from 2014 by Quick et al. (2014) (Figure 16.1). You can read this paper to get the full detail.\nThe sequences you worked with are real sequences (you can look up the accession numbers at NCBI), and the ward layout is real. Some details were changed slightly for pedagogical reasons, but by and large you’ve been doing the same kind of analysis as in that paper, the key points of which are summarised below.",
    "crumbs": [
      "Conclusion",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Epilogue</span>"
    ]
  },
  {
    "objectID": "epilogue.html#the-real-study",
    "href": "epilogue.html#the-real-study",
    "title": "16  Epilogue",
    "section": "",
    "text": "Figure 16.1: Front matter of the Quick et al. (2014) paper on which this workshop is based",
    "crumbs": [
      "Conclusion",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Epilogue</span>"
    ]
  },
  {
    "objectID": "epilogue.html#what-kind-of-hospital-was-it",
    "href": "epilogue.html#what-kind-of-hospital-was-it",
    "title": "16  Epilogue",
    "section": "16.2 What kind of hospital was it?",
    "text": "16.2 What kind of hospital was it?\nThis was a purpose-built burns centre located in the Midlands in England, opened in 2010 and admitting around 300 patients each year. The burns centre is laid out just as in Figure 15.1.",
    "crumbs": [
      "Conclusion",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Epilogue</span>"
    ]
  },
  {
    "objectID": "epilogue.html#how-was-the-study-performed",
    "href": "epilogue.html#how-was-the-study-performed",
    "title": "16  Epilogue",
    "section": "16.3 How was the study performed?",
    "text": "16.3 How was the study performed?\nThis was an observational prospective study designed to determine if whole genome sequencing (WGS) could be helpful for determining likely sources of P. aeruginosa in a hospital setting. Hydrotherapy is a major part of burns treatments, and there was an overarching hypothesis that patients were acquiring P. aeruginosa from hospital shower water.\nPatients were screened for having greater than 7% total body surface area burns injuries, and they or a legal consultee gave written consent for participation. Recruited patients were also screened for carriage of P. aeruginosa from outside sources.\nSamples were taken from patient wounds, urine and stool, and also from environmental samples. Patient, environmental and water samples were taken after the patients were admitted. The environment and water sources were also sampled after patient discharge.",
    "crumbs": [
      "Conclusion",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Epilogue</span>"
    ]
  },
  {
    "objectID": "epilogue.html#what-did-they-find",
    "href": "epilogue.html#what-did-they-find",
    "title": "16  Epilogue",
    "section": "16.4 What did they find?",
    "text": "16.4 What did they find?\n\n\n\n\n\n\nThe water and environment in burns and critical care unites are frequently colonised by P. aeruginosa\n\n\n\nAround 50% of water samples, 26% of wet environment samples, and 6% of dry environment samples were positive for P. aeruginosa.\nAround 50% of patient samples were positive for P. aeruginosa.\nEight distinct clades of P. aeruginosa were identified, and there was no niche preference by clade.\n\n\n\n\n\n\n\n\nPotential transmission events detected by WGS\n\n\n\nPatients P01 and P04 (samples used in this workshop) were found to have a P. aeruginosa genotype indistinguishable from that of the water and environment of bed 11.\nOther patients in the study were positive for P. aeruginosa but environmental or water samples of the same genotype were only found during the duration of their stay, not before or after. This suggested that the patients introduced those lineages to the unit.\nPhylogenetic reconstruction from strains including those in this workshop, in conjunction with the plan of the unit, identified a common source of infection.\n\n\n\n\n\n\n\n\nIdentification of a potential infection source\n\n\n\nThe study team obtained a thermostatic mixed valve (TMV) from the hospital estates team, which had been taken from bed 9.\nThey sequenced a biofilm scraped from this valve, and found reads mapping to P. aeruginosa of the same clade that infected patients in room 11. It appears that persistent biofilms in water systems are a plausible source of P. aeruginosa infections.",
    "crumbs": [
      "Conclusion",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Epilogue</span>"
    ]
  },
  {
    "objectID": "epilogue.html#limitations-of-the-study",
    "href": "epilogue.html#limitations-of-the-study",
    "title": "16  Epilogue",
    "section": "16.5 Limitations of the study",
    "text": "16.5 Limitations of the study\n\n\n\n\nQuick, Joshua, Nicola Cumley, Christopher M Wearn, Marc Niebel, Chrystala Constantinidou, Chris M Thomas, Mark J Pallen, et al. 2014. “Seeking the Source of Pseudomonas Aeruginosa Infections in a Recently Opened Hospital: An Observational Study Using Whole-Genome Sequencing.” BMJ Open 4 (11): e006278.",
    "crumbs": [
      "Conclusion",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Epilogue</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Breathnach, A S, M D Cubbon, R N Karunaharan, C F Pope, and T D Planche.\n2012. “Multidrug-Resistant Pseudomonas Aeruginosa Outbreaks in Two\nHospitals: Association with Contaminated Hospital Waste-Water\nSystems.” J. Hosp. Infect. 82 (1): 19–24.\n\n\nCarver, Tim, Simon R Harris, Matthew Berriman, Julian Parkhill, and\nJacqueline A McQuillan. 2012. “Artemis: An Integrated Platform for\nVisualization and Analysis of High-Throughput Sequence-Based\nExperimental Data.” Bioinformatics 28 (4): 464–69.\n\n\nCock, Peter J A, Björn A Grüning, Konrad Paszkiewicz, and Leighton\nPritchard. 2013. “Galaxy Tools and Workflows for Sequence Analysis\nwith Applications in Molecular Plant Pathology.” PeerJ 1\n(September): e167.\n\n\nDiesh, Colin, Garrett J Stevens, Peter Xie, Teresa De Jesus Martinez,\nElliot A Hershberg, Angel Leung, Emma Guo, et al. 2023.\n“JBrowse 2: A Modular Genome Browser with Views of\nSynteny and Structural Variation.” Genome Biol. 24 (1):\n74.\n\n\nGalaxy Community. 2024. “The Galaxy Platform for Accessible,\nReproducible, and Collaborative Data Analyses: 2024 Update.”\nNucleic Acids Res. 52 (W1): W83–94.\n\n\nGrant, Jason R, Eric Enns, Eric Marinier, Arnab Mandal, Emily K Herman,\nChih-Yu Chen, Morag Graham, Gary Van Domselaar, and Paul Stothard. 2023.\n“Proksee: In-Depth Characterization and Visualization of Bacterial\nGenomes.” Nucleic Acids Res. 51 (W1): W484–92.\n\n\nMahar, Patrick, Alexander A Padiglione, Heather Cleland, Eldho Paul,\nMelissa Hinrichs, and Jason Wasiak. 2010. “Pseudomonas Aeruginosa\nBacteraemia in Burns Patients: Risk Factors and Outcomes.”\nBurns 36 (8): 1228–33.\n\n\nMilne, Iain, Gordon Stephen, Micha Bayer, Peter J A Cock, Leighton\nPritchard, Linda Cardle, Paul D Shaw, and David Marshall. 2013.\n“Using Tablet for Visual Exploration of Second-Generation\nSequencing Data.” Brief. Bioinform. 14 (2): 193–202.\n\n\nParks, Donovan H, Michael Imelfort, Connor T Skennerton, Philip\nHugenholtz, and Gene W Tyson. 2015. “CheckM:\nAssessing the Quality of Microbial Genomes Recovered from Isolates,\nSingle Cells, and Metagenomes.” Genome Res. 25 (7):\n1043–55.\n\n\nPrjibelski, Andrey, Dmitry Antipov, Dmitry Meleshko, Alla Lapidus, and\nAnton Korobeynikov. 2020. “Using SPAdes\nDE Novo Assembler.” Curr. Protoc.\nBioinformatics 70 (1): e102.\n\n\nQuick, Joshua, Nicola Cumley, Christopher M Wearn, Marc Niebel,\nChrystala Constantinidou, Chris M Thomas, Mark J Pallen, et al. 2014.\n“Seeking the Source of Pseudomonas Aeruginosa Infections in a\nRecently Opened Hospital: An Observational Study Using Whole-Genome\nSequencing.” BMJ Open 4 (11): e006278.\n\n\nReynolds, Dan, and Marin Kollef. 2021. “The Epidemiology and\nPathogenesis and Treatment of Pseudomonas Aeruginosa Infections: An\nUpdate.” Drugs 81 (18): 2117–31.\n\n\nRoy, Souvik, Preeti Mukherjee, Sutrisha Kundu, Debashrita Majumder,\nVivek Raychaudhuri, and Lopamudra Choudhury. 2024. “Microbial\nInfections in Burn Patients.” Acute Crit. Care 39 (2):\n214–25.\n\n\nStover, C K, X Q Pham, A L Erwin, S D Mizoguchi, P Warrener, M J Hickey,\nF S Brinkman, et al. 2000. “Complete Genome Sequence of\nPseudomonas Aeruginosa PAO1, an Opportunistic\nPathogen.” Nature 406 (6799): 959–64.\n\n\nTrautmann, Matthias, Philipp M Lepper, and Mathias Haller. 2005.\n“Ecology of Pseudomonas Aeruginosa in the Intensive Care Unit and\nthe Evolving Role of Water Outlets as a Reservoir of the\nOrganism.” Am. J. Infect. Control 33 (5 Suppl 1): S41–9.\n\n\nVasimuddin, Md, Sanchit Misra, Heng Li, and Srinivas Aluru. 2019.\n“Efficient Architecture-Aware Acceleration of BWA-MEM\nfor Multicore Systems.” In 2019 IEEE\nInternational Parallel and Distributed Processing Symposium\n(IPDPS). Rio de Janeiro, Brazil: IEEE.\n\n\nWick, Ryan R, Mark B Schultz, Justin Zobel, and Kathryn E Holt. 2015.\n“Bandage: Interactive Visualization of de Novo Genome\nAssemblies.” Bioinformatics 31 (20): 3350–52.\n\n\nWise, Jacqui. 2012. “Three Babies Die in Pseudomonas Outbreak at\nBelfast Neonatal Unit.” BMJ 344 (jan24 1): e592.",
    "crumbs": [
      "References"
    ]
  }
]